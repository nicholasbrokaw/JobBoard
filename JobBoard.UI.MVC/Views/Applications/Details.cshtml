@model JobBoard.DATA.EF.Application
@using JobBoard.DATA.EF

@{
	ViewBag.Title = "Review Application";

	JobBoardEntities db = new JobBoardEntities();
}

<h2>@ViewBag.Title</h2>

<div>
	<h4>Application</h4>
	<hr />
	<dl class="dl-horizontal">

		<dt>
			@Html.DisplayNameFor(model => model.OpenPosition.Position.Title)
		</dt>
		<dd>
			@Html.DisplayFor(model => model.OpenPosition.Position.Title)
		</dd>

		@if (!User.IsInRole("Employee"))
		{
			<dt>
				@Html.DisplayNameFor(model => model.UserDetail.FullName)
			</dt>
			<dd>
				@Html.DisplayFor(model => model.UserDetail.FullName)
			</dd>

			<dt>
				@Html.DisplayNameFor(model => model.ManagerNotes)
			</dt>
			<dd>
				@Html.DisplayFor(model => model.ManagerNotes)
			</dd>
		}

		<dt>
			@Html.DisplayNameFor(model => model.ApplicationDate)
		</dt>
		<dd>
			@Html.DisplayFor(model => model.ApplicationDate)
		</dd>

		<dt>
			@Html.DisplayNameFor(model => model.ResumeFilename)
		</dt>
		<dd>
			<embed src="@Url.Content($"~/Content/resumes/{Model.ResumeFilename}")" />
		</dd>

		<dt>
			@Html.DisplayNameFor(model => model.ApplicationStatus.StatusName)
		</dt>
		<dd>
			@Html.DisplayFor(model => model.ApplicationStatus.StatusName)
		</dd>

		<dt>
			@Html.DisplayNameFor(model => model.OpenPosition.Location.Summary)
		</dt>
		<dd>
			@Html.DisplayFor(model => model.OpenPosition.Location.Summary)
		</dd>

	</dl>
</div>
<p>
	@if (Model.ApplicationStatusId == db.ApplicationStatuses.Where(s => s.StatusName.ToLower() == "pending").Select(s => s.ApplicationStatusId).Single() && User.IsInRole("Manager"))
	{
		@Html.ActionLink("Edit", "Edit", new { id = Model.ApplicationId }) <span>|</span>
	}
	@Html.ActionLink("Back to List", "Index")
</p>
